<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>PyBCN Dojo: Gilded Rose Refactoring Kata</title>
<meta name="author" content="(Ignasi Fosch)"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="http://cdn.jsdelivr.net/reveal.js/3.0.0/css/reveal.css"/>

<link rel="stylesheet" href="http://cdn.jsdelivr.net/reveal.js/3.0.0/css/theme/beige.css" id="theme"/>

<link rel="stylesheet" href="dojos.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'http://cdn.jsdelivr.net/reveal.js/3.0.0/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><h1>PyBCN Dojo: Gilded Rose Refactoring Kata</h1><h2>Ignasi Fosch</h2>
</section>
<section id="table-of-contents">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#/slide-orga9d3097">Dojo session</a></li>
<li><a href="#/slide-org16545e9">Gilded Rose Refactoring Kata</a>
<ul>
<li><a href="#/slide-org32629f8">The Gilded Rose Inn</a></li>
<li><a href="#/slide-org5db3efa">Get your gear!</a></li>
<li><a href="#/slide-org06bf9e5">Equip your gear</a></li>
<li><a href="#/slide-orgc574332">Getting down the dungeon</a></li>
<li><a href="#/slide-org6491eef">The return to the Gilded Rose Inn</a></li>
</ul>
</li>
<li><a href="#/slide-org09870be">Gilded Rose Refactoring Kata Retrospective</a></li>
</ul>
</div>
</div>
</section>

<section>
<section id="slide-orga9d3097">
<h2 id="orga9d3097">Dojo session</h2>
<div class="outline-text-2" id="text-orga9d3097">
</div>
</section>
<section id="slide-org0fb03fb">
<h4 id="org0fb03fb">Coding dojo goals</h4>
<ul>
<li>Enjoy coding with friends</li>
<li>Learn about techniques and tools from others</li>
<li>Share knowledge with others</li>
<li>Practice new techniques and tools in a safe environment</li>

</ul>
</section>
<section id="slide-org6a4b488">
<h4 id="org6a4b488">Coding dojo principles</h4>
<ul>
<li>No competition, no target, no prizes</li>
<li>Practice and experiment</li>
<li>Master a subject</li>
<li>Understand and offer own knowledge</li>
<li>Show own code and examples</li>
<li>Forget to learn again</li>
<li>Baby steps, not in a rush</li>
<li>Listen others</li>

</ul>
</section>
<section id="slide-orgbb41764">
<h4 id="orgbb41764">Coding dojo cycle</h4>

<div class="figure">
<p><img src="dojo_cycle.png" alt="dojo_cycle.png" />
</p>
</div>

</section>
</section>
<section>
<section id="slide-org16545e9">
<h2 id="org16545e9">Gilded Rose Refactoring Kata</h2>
<div class="outline-text-2" id="text-org16545e9">
</div>
</section>
</section>
<section>
<section id="slide-org32629f8">
<h3 id="org32629f8">The Gilded Rose Inn</h3>
<p>
Hi and welcome to team Gilded Rose.
</p>

<p>
As you know, we are a small inn with a prime location in a prominent city ran by a friendly innkeeper named Allison.
We also buy and sell only the finest goods.
Unfortunately, our goods are constantly degrading in quality as they approach their sell by date.
We have a system in place that updates our inventory for us.
It was developed by a no-nonsense type named Leeroy, who has moved on to new adventures.
</p>

</section>
<section >

<p>
First an introduction to our system:
</p>
<ul>
<li>All items have a <code>sell_in</code> value which denotes the number of days we have to sell the item</li>
<li>All items have a quality value which denotes how valuable the item is</li>
<li>At the end of each day our system lowers both values for every item</li>

</ul>

</section>
<section >

<p>
Pretty simple, right?
Well, this is where it gets interesting:
</p>
<ul>
<li>Once the sell by date has passed, quality degrades twice as fast</li>
<li>The quality of an item is never negative</li>
<li>“Aged Brie” actually increases in quality the older it gets</li>
<li>The quality of an item is never more than 50</li>
<li>“Sulfuras&#x2026;”, being a legendary item, never has to be sold or decreases in quality</li>
<li>“Backstage passes&#x2026;”, like aged brie, increases in quality as it’s <code>sell_in</code> value approaches; quality increases by 2 when there are 10 days or less and by 3 when there are 5 days or less but quality drops to 0 after the concert</li>

</ul>

</section>
<section >

<p>
Feel free to make any changes to the <code>update_quality</code> method and add any new code as long as everything still works correctly.
However, do not alter the Item class or items property as those belong to the goblin in the corner who will insta-rage and one-shot you as he doesn’t believe in shared code ownership (you can make the <code>update_quality</code> method and items property static if you like, we’ll cover for you).
</p>

</section>
</section>
<section>
<section id="slide-org5db3efa">
<h3 id="org5db3efa">Get your gear!</h3>
<p>
For this quest, you have been provided with some items that will help you&#x2026;
</p>

<p>
You've been provided with a fixture generator, which generates example runs with many cases.
</p>

</section>
<section >

<p>
You can use it like this, argument is the number of days to count for update:
</p>

<pre class="example">
$ python generate_fixture.py 1
-------- day 0 --------
name, sellIn, quality
+5 Dexterity Vest, 10, 20
Aged Brie, 2, 0
Elixir of the Mongoose, 5, 7
Sulfuras, Hand of Ragnaros, 0, 80
Sulfuras, Hand of Ragnaros, -1, 80
Backstage passes to a TAFKAL80ETC concert, 15, 20
Backstage passes to a TAFKAL80ETC concert, 10, 49
Backstage passes to a TAFKAL80ETC concert, 5, 49
Conjured Mana Cake, 3, 6

</pre>

</section>
<section >

<pre class="example">
-------- day 1 --------
name, sellIn, quality
+5 Dexterity Vest, 9, 19
Aged Brie, 1, 1
Elixir of the Mongoose, 4, 6
Sulfuras, Hand of Ragnaros, 0, 80
Sulfuras, Hand of Ragnaros, -1, 80
Backstage passes to a TAFKAL80ETC concert, 14, 21
Backstage passes to a TAFKAL80ETC concert, 9, 50
Backstage passes to a TAFKAL80ETC concert, 4, 50
Conjured Mana Cake, 2, 5

</pre>

</section>
<section >

<p>
You are strongly recommended to run this command with an appropriate number of days as argument, redirecting the output to a <code>golden_master.txt</code> file.
That way, while refactoring, you'll be able to check the output of the following command to ensure everything is ok:
</p>

<pre class="example">
$ bash run_tests
============================= test session starts ==============================
platform linux -- Python 3.5.4, pytest-3.2.3, py-1.4.34, pluggy-0.4.0
rootdir: /home/ifosch/src/github.com/BCNDojos/pyDojos/gilded-rose, inifile:
collected 1 item

test_gilded_rose.py .

======================== 1 passed in 0.00 seconds ==============================

</pre>

</section>
<section id="slide-orga272810">
<h4 id="orga272810">Get some scrolls</h4>
<p>
If you take a look to <code>run_tests</code> it will show how many days it is using to generate the fixture:
</p>

<div class="org-src-container">

<pre  class="src src-bash">pytest . &amp;&amp; python generate_fixture.py <span style="color: #AE81FF;">27</span> &gt; test_output.txt &amp;&amp; diff test_output.txt golden_master.txt
</pre>
</div>

<p>
So, this bash script runs <code>pytest</code> on current directory.
If it works ok, then, it runs the fixture generator for 27 days, storing output to <code>test_output.txt</code>.
If this doesn't fail, then it compares output from current code with the fixture file.
This fixture file is what needs to be generated in this step.
</p>

</section>
<section >

<p>
Let's run it like this:
</p>

<div class="org-src-container">

<pre  class="src src-nilang">python generate_fixture.py 27 &gt; golden_master.txt
</pre>
</div>

</section>
<section id="slide-org1a247f1">
<h4 id="org1a247f1">Learn some magic</h4>
<p>
Let's look at the file now, and check how the business rules are applied by the current implementation:
</p>

<div class="org-src-container">

<pre  class="src src-bash">-------- day <span style="color: #AE81FF;">0</span> --------
name, sellIn, quality
+5 Dexterity Vest, <span style="color: #AE81FF;">10,</span> <span style="color: #AE81FF;">20</span>
Aged Brie, <span style="color: #AE81FF;">2,</span> <span style="color: #AE81FF;">0</span>
Elixir of the Mongoose, <span style="color: #AE81FF;">5,</span> <span style="color: #AE81FF;">7</span>
Sulfuras, Hand of Ragnaros, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">80</span>
Sulfuras, Hand of Ragnaros, -1, <span style="color: #AE81FF;">80</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">15,</span> <span style="color: #AE81FF;">20</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">10,</span> <span style="color: #AE81FF;">49</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">5,</span> <span style="color: #AE81FF;">49</span>
Conjured Mana Cake, <span style="color: #AE81FF;">3,</span> <span style="color: #AE81FF;">6</span>

-------- day <span style="color: #AE81FF;">1</span> --------
name, sellIn, quality
+5 Dexterity Vest, <span style="color: #AE81FF;">9,</span> <span style="color: #AE81FF;">19</span>
Aged Brie, <span style="color: #AE81FF;">1,</span> <span style="color: #AE81FF;">1</span>
Elixir of the Mongoose, <span style="color: #AE81FF;">4,</span> <span style="color: #AE81FF;">6</span>
Sulfuras, Hand of Ragnaros, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">80</span>
Sulfuras, Hand of Ragnaros, -1, <span style="color: #AE81FF;">80</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">14,</span> <span style="color: #AE81FF;">21</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">9,</span> <span style="color: #AE81FF;">50</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">4,</span> <span style="color: #AE81FF;">50</span>
Conjured Mana Cake, <span style="color: #AE81FF;">2,</span> <span style="color: #AE81FF;">5</span>
</pre>
</div>

</section>
<section >

<p>
From these first 24 lines, we can infer the following:
</p>
<ul>
<li><i>Normal</i> items, like <code>+5 Dexterity Vest</code>, <code>Elixir of the Mongoose</code>, or <code>Conjured Mana Cake</code>, are treated as described, so far; meaning these items' <code>sell_in</code> and <code>quality</code> attributes are decreased in 1</li>
<li><code>Aged Brie</code>, as specified, increases quality as getting older</li>
<li><code>Sulfuras...</code> are kept untouched, even when the <code>quality &gt; 50</code>, or when the <code>sell_in</code> date was reached</li>
<li><code>Backstage passes...</code> are also treated as specified, so far</li>

</ul>

</section>
<section >

<div class="org-src-container">

<pre  class="src src-bash">-------- day <span style="color: #AE81FF;">2</span> --------
name, sellIn, quality
+5 Dexterity Vest, <span style="color: #AE81FF;">8,</span> <span style="color: #AE81FF;">18</span>
Aged Brie, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">2</span>
Elixir of the Mongoose, <span style="color: #AE81FF;">3,</span> <span style="color: #AE81FF;">5</span>
Sulfuras, Hand of Ragnaros, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">80</span>
Sulfuras, Hand of Ragnaros, -1, <span style="color: #AE81FF;">80</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">13,</span> <span style="color: #AE81FF;">22</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">8,</span> <span style="color: #AE81FF;">50</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">3,</span> <span style="color: #AE81FF;">50</span>
Conjured Mana Cake, <span style="color: #AE81FF;">1,</span> <span style="color: #AE81FF;">4</span>

-------- day <span style="color: #AE81FF;">3</span> --------
name, sellIn, quality
+5 Dexterity Vest, <span style="color: #AE81FF;">7,</span> <span style="color: #AE81FF;">17</span>
Aged Brie, -1, <span style="color: #AE81FF;">4</span>
Elixir of the Mongoose, <span style="color: #AE81FF;">2,</span> <span style="color: #AE81FF;">4</span>
Sulfuras, Hand of Ragnaros, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">80</span>
Sulfuras, Hand of Ragnaros, -1, <span style="color: #AE81FF;">80</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">12,</span> <span style="color: #AE81FF;">23</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">7,</span> <span style="color: #AE81FF;">50</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">2,</span> <span style="color: #AE81FF;">50</span>
Conjured Mana Cake, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">3</span>
</pre>
</div>

</section>
<section >

<p>
These other lines show us some more details:
</p>
<ul>
<li>As described, <code>Aged Brie</code> increases <code>quality</code> twice, once the <code>sell_in</code> date has been reached</li>
<li>Two of the <code>Backstage passes...</code> items have reached maximum <code>quality</code>, so these can't got it better</li>
<li>The behaviour of the rest of the items is as expected</li>

</ul>

</section>
<section >

<div class="org-src-container">

<pre  class="src src-bash">-------- day <span style="color: #AE81FF;">5</span> --------
name, sellIn, quality
+5 Dexterity Vest, <span style="color: #AE81FF;">5,</span> <span style="color: #AE81FF;">15</span>
Aged Brie, -3, <span style="color: #AE81FF;">8</span>
Elixir of the Mongoose, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">2</span>
Sulfuras, Hand of Ragnaros, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">80</span>
Sulfuras, Hand of Ragnaros, -1, <span style="color: #AE81FF;">80</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">10,</span> <span style="color: #AE81FF;">25</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">5,</span> <span style="color: #AE81FF;">50</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">50</span>
Conjured Mana Cake, -2, <span style="color: #AE81FF;">0</span>

-------- day <span style="color: #AE81FF;">6</span> --------
name, sellIn, quality
+5 Dexterity Vest, <span style="color: #AE81FF;">4,</span> <span style="color: #AE81FF;">14</span>
Aged Brie, -4, <span style="color: #AE81FF;">10</span>
Elixir of the Mongoose, -1, <span style="color: #AE81FF;">0</span>
Sulfuras, Hand of Ragnaros, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">80</span>
Sulfuras, Hand of Ragnaros, -1, <span style="color: #AE81FF;">80</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">9,</span> <span style="color: #AE81FF;">27</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">4,</span> <span style="color: #AE81FF;">50</span>
Backstage passes to a TAFKAL80ETC concert, -1, <span style="color: #AE81FF;">0</span>
Conjured Mana Cake, -3, <span style="color: #AE81FF;">0</span>
</pre>
</div>

</section>
<section >

<p>
In this part of the file, we can see the following:
</p>
<ul>
<li><i>Normal</i> items that passed <code>sell_in</code> date, like <code>Elixir of the Mongoose</code> or <code>Conjured Mana Cake</code> here, get 0 <code>quality</code></li>
<li><code>Backstage passes...</code> having <code>sell_in &lt; 10</code> increase their <code>quality</code> twice</li>
<li><code>Backstage passes...</code> having passed their <code>sell_in</code>, get 0 <code>quality</code></li>

</ul>

</section>
<section >

<div class="org-src-container">

<pre  class="src src-bash">-------- day <span style="color: #AE81FF;">10</span> --------
name, sellIn, quality
+5 Dexterity Vest, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">10</span>
Aged Brie, -8, <span style="color: #AE81FF;">18</span>
Elixir of the Mongoose, -5, <span style="color: #AE81FF;">0</span>
Sulfuras, Hand of Ragnaros, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">80</span>
Sulfuras, Hand of Ragnaros, -1, <span style="color: #AE81FF;">80</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">5,</span> <span style="color: #AE81FF;">35</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">50</span>
Backstage passes to a TAFKAL80ETC concert, -5, <span style="color: #AE81FF;">0</span>
Conjured Mana Cake, -7, <span style="color: #AE81FF;">0</span>

-------- day <span style="color: #AE81FF;">11</span> --------
name, sellIn, quality
+5 Dexterity Vest, -1, <span style="color: #AE81FF;">8</span>
Aged Brie, -9, <span style="color: #AE81FF;">20</span>
Elixir of the Mongoose, -6, <span style="color: #AE81FF;">0</span>
Sulfuras, Hand of Ragnaros, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">80</span>
Sulfuras, Hand of Ragnaros, -1, <span style="color: #AE81FF;">80</span>
Backstage passes to a TAFKAL80ETC concert, <span style="color: #AE81FF;">4,</span> <span style="color: #AE81FF;">38</span>
Backstage passes to a TAFKAL80ETC concert, -1, <span style="color: #AE81FF;">0</span>
Backstage passes to a TAFKAL80ETC concert, -6, <span style="color: #AE81FF;">0</span>
Conjured Mana Cake, -8, <span style="color: #AE81FF;">0</span>
</pre>
</div>

</section>
<section >

<p>
Here, the only thing left to confirm is that <code>Backstage passes...</code> having less than 5 days to <code>sell_in</code>, increase quality by 3.
</p>

</section>
<section >

<div class="org-src-container">

<pre  class="src src-bash">-------- day <span style="color: #AE81FF;">26</span> --------
name, sellIn, quality
+5 Dexterity Vest, -16, <span style="color: #AE81FF;">0</span>
Aged Brie, -24, <span style="color: #AE81FF;">50</span>
Elixir of the Mongoose, -21, <span style="color: #AE81FF;">0</span>
Sulfuras, Hand of Ragnaros, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">80</span>
Sulfuras, Hand of Ragnaros, -1, <span style="color: #AE81FF;">80</span>
Backstage passes to a TAFKAL80ETC concert, -11, <span style="color: #AE81FF;">0</span>
Backstage passes to a TAFKAL80ETC concert, -16, <span style="color: #AE81FF;">0</span>
Backstage passes to a TAFKAL80ETC concert, -21, <span style="color: #AE81FF;">0</span>
Conjured Mana Cake, -23, <span style="color: #AE81FF;">0</span>

-------- day <span style="color: #AE81FF;">27</span> --------
name, sellIn, quality
+5 Dexterity Vest, -17, <span style="color: #AE81FF;">0</span>
Aged Brie, -25, <span style="color: #AE81FF;">50</span>
Elixir of the Mongoose, -22, <span style="color: #AE81FF;">0</span>
Sulfuras, Hand of Ragnaros, <span style="color: #AE81FF;">0,</span> <span style="color: #AE81FF;">80</span>
Sulfuras, Hand of Ragnaros, -1, <span style="color: #AE81FF;">80</span>
Backstage passes to a TAFKAL80ETC concert, -12, <span style="color: #AE81FF;">0</span>
Backstage passes to a TAFKAL80ETC concert, -17, <span style="color: #AE81FF;">0</span>
Backstage passes to a TAFKAL80ETC concert, -22, <span style="color: #AE81FF;">0</span>
Conjured Mana Cake, -24, <span style="color: #AE81FF;">0</span>
</pre>
</div>

</section>
<section >

<p>
Finally, the last two days updates can't increase <code>Aged Brie</code>'s <code>quality</code> over 50.
</p>

</section>
</section>
<section>
<section id="slide-org06bf9e5">
<h3 id="org06bf9e5">Equip your gear</h3>
<p>
Before going on, you should also fill up the <code>test_gilded_rose.py</code> with tests for the all use cases&#x2026;
Be careful, there'll be dragons!
</p>

</section>
<section id="slide-orgde03928">
<h4 id="orgde03928">Equipping one <i>Normal</i> item</h4>
<p>
Let's start by discarding current tests in <code>test_gilded_rose.py</code>, and start a new test from scratch for normal items updates.
</p>

<p>
Remember the <i>AAA</i> principle.
</p>

<p>
As a recomendation, avoid to implement too complex test functions, at least, at the beginning. Readability and simplicity are more valuable than completeness and broad scopes.
</p>

</section>
<section >

<p>
Let's take this as example:
</p>

<div class="org-src-container">

<pre  class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">test_normal_items</span><span style="color: #AE81FF;">()</span>:
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Arrange</span>
    <span style="color: #FD971F;">test_case</span> = <span style="color: #AE81FF;">(</span>
        Item<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, <span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">4</span><span style="color: #66D9EF;">)</span>,
        Item<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, <span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">3</span><span style="color: #66D9EF;">)</span>,
    <span style="color: #AE81FF;">)</span>
    <span style="color: #FD971F;">items</span> = <span style="color: #AE81FF;">[</span>test_case<span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">gilded_rose</span> = GildedRose<span style="color: #AE81FF;">(</span>items<span style="color: #AE81FF;">)</span>
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Act</span>
    gilded_rose.update_quality<span style="color: #AE81FF;">()</span>
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Assert</span>
    <span style="color: #F92672;">for</span> item <span style="color: #F92672;">in</span> items:
        <span style="color: #F92672;">assert</span> item.sell_in == test_case<span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>.sell_in
        <span style="color: #F92672;">assert</span> item.quality == test_case<span style="color: #AE81FF;">[</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>.quality
</pre>
</div>

</section>
<section >

<p>
Now, let's check this is working fine:
</p>

<div class="org-src-container">

<pre  class="src src-bash">pytest .
</pre>
</div>

<pre class="example">
============================= test session starts ==============================
platform linux -- Python 3.5.4, pytest-3.2.3, py-1.4.34, pluggy-0.4.0
rootdir: /home/ifosch/src/github.com/BCNDojos/pyDojos/gilded-rose, inifile:
collected 1 item

test_gilded_rose.py .

=========================== 1 passed in 0.01 seconds ===========================
</pre>

</section>
<section id="slide-org0d0babc">
<h4 id="org0d0babc">Equipping one more <i>Normal</i> item</h4>
<p>
The test just created is testing one single case, i.e. a normal item which is not reaching its <code>sell_in</code> date.
</p>

<p>
Next step will be to modify this test to check what happens when a normal item's <code>sell_in</code> date is reached.
</p>

</section>
<section >

<p>
Starting from the last test, we can do the following:
</p>

<div class="org-src-container">

<pre  class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">test_normal_items</span><span style="color: #AE81FF;">()</span>:
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Arrange</span>
    <span style="color: #FD971F;">test_cases</span> = <span style="color: #AE81FF;">[</span>
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, <span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">4</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, <span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">3</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, <span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">3</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, <span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">2</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
    <span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">items</span> = <span style="color: #AE81FF;">[</span>test_case<span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #66D9EF;">]</span> <span style="color: #F92672;">for</span> test_case <span style="color: #F92672;">in</span> test_cases<span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">gilded_rose</span> = GildedRose<span style="color: #AE81FF;">(</span>items<span style="color: #AE81FF;">)</span>
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Act</span>
    gilded_rose.update_quality<span style="color: #AE81FF;">()</span>
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Assert</span>
    <span style="color: #F92672;">for</span> i, item <span style="color: #F92672;">in</span> <span style="color: #F92672;">enumerate</span><span style="color: #AE81FF;">(</span>items<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">assert</span> item.sell_in == test_cases<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>.sell_in
        <span style="color: #F92672;">assert</span> item.quality == test_cases<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>.quality
</pre>
</div>

</section>
<section >

<p>
Now, let's check this is working fine:
</p>

<div class="org-src-container">

<pre  class="src src-bash">pytest .
</pre>
</div>

<pre class="example">
============================= test session starts ==============================
platform linux -- Python 3.5.4, pytest-3.2.3, py-1.4.34, pluggy-0.4.0
rootdir: /home/ifosch/src/github.com/BCNDojos/pyDojos/gilded-rose, inifile:
collected 1 item

test_gilded_rose.py .

=========================== 1 passed in 0.01 seconds ===========================
</pre>

<p>
This is good, but, what will happen when more normal items are to be added?
</p>

</section>
<section id="slide-orgd1d9735">
<h4 id="orgd1d9735">Equipping more <i>Normal</i> items</h4>
<p>
The test for normal items is not testing the cases where the item decreases twice as fast, until reaching 0 quality.
Note that these are two different cases:
</p>
<ul>
<li>decreasing twice as fast</li>
<li><code>quality</code> can't be negative</li>

</ul>

<p>
Next step will be to modify the test code to check what happens in these two cases.
</p>

</section>
<section >

<p>
Keeping the paced stepping we have been taking, an option could be just to add the corresponding test cases:
</p>

<div class="org-src-container">

<pre  class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">test_normal_items</span><span style="color: #AE81FF;">()</span>:
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Arrange</span>
    <span style="color: #FD971F;">test_cases</span> = <span style="color: #AE81FF;">[</span>
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, <span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">4</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, <span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">3</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, <span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">3</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, <span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">2</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, <span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">2</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, -<span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">0</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, -<span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">0</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"+5 Dexterity Vest"</span>, -<span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">0</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
    <span style="color: #AE81FF;">]</span>
    ...
</pre>
</div>

</section>
<section >

<p>
And it would still work fine:
</p>

<div class="org-src-container">

<pre  class="src src-bash">pytest .
</pre>
</div>

<pre class="example">
============================= test session starts ==============================
platform linux -- Python 3.5.4, pytest-3.2.3, py-1.4.34, pluggy-0.4.0
rootdir: /home/ifosch/src/github.com/BCNDojos/pyDojos/gilded-rose, inifile:
collected 1 item

test_gilded_rose.py .
=========================== 1 passed in 0.03 seconds ===========================
</pre>

</section>
<section id="slide-org75dbbfc">
<h4 id="org75dbbfc">Equipping <code>Aged Brie</code> items</h4>
<p>
Next step will be to implement tests for <code>Aged Brie</code> items.
</p>

</section>
<section >

<p>
In this case, easiest approach would be to copy the <i>Normal</i> items test function, and modify it with the appropriated test cases:
</p>

<div class="org-src-container">

<pre  class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">test_aged_brie_items</span><span style="color: #AE81FF;">()</span>:
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Arrange</span>
    <span style="color: #FD971F;">test_cases</span> = <span style="color: #AE81FF;">[</span>
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Aged Brie"</span>, <span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">4</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Aged Brie"</span>, <span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">5</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Aged Brie"</span>, <span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">5</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Aged Brie"</span>, <span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">6</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Aged Brie"</span>, <span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">6</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Aged Brie"</span>, -<span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">8</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Aged Brie"</span>, -<span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">49</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Aged Brie"</span>, -<span style="color: #AE81FF;">2</span>, <span style="color: #AE81FF;">50</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
    <span style="color: #AE81FF;">]</span>
    ...
</pre>
</div>

</section>
<section >

<p>
This should work also fine:
</p>

<div class="org-src-container">

<pre  class="src src-bash">pytest .
</pre>
</div>

<pre class="example">
============================= test session starts ==============================
platform linux -- Python 3.5.4, pytest-3.2.3, py-1.4.34, pluggy-0.4.0
rootdir: /home/ifosch/src/github.com/BCNDojos/pyDojos/gilded-rose, inifile:
collected 2 items

test_gilded_rose.py ..

=========================== 2 passed in 0.03 seconds ===========================
</pre>

</section>
<section id="slide-orgd68791a">
<h4 id="orgd68791a">Equipping <code>Backstage passes...</code> items</h4>
<p>
Next step will be to implement tests for <code>Backstage passes...</code> items.
</p>

</section>
<section >

<p>
In this case, one approach would be to repeat what was done for the <code>Aged Brie</code>, but it would be a good moment to add some generalization to the tests code.
</p>

<p>
The Act and Assert parts of all the test functions are the same, thus these can be parametrized.
</p>

</section>
<section >

<p>
Let's create the following helper functions:
</p>

<div class="org-src-container">

<pre  class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">update_arrange</span><span style="color: #AE81FF;">(</span>test_cases<span style="color: #AE81FF;">)</span>:
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Arrange</span>
    <span style="color: #FD971F;">items</span> = <span style="color: #AE81FF;">[</span>test_case<span style="color: #66D9EF;">[</span><span style="color: #AE81FF;">0</span><span style="color: #66D9EF;">]</span> <span style="color: #F92672;">for</span> test_case <span style="color: #F92672;">in</span> test_cases<span style="color: #AE81FF;">]</span>
    <span style="color: #FD971F;">gilded_rose</span> = GildedRose<span style="color: #AE81FF;">(</span>items<span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">return</span> items, gilded_rose
</pre>
</div>

</section>
<section >

<p>
And:
</p>

<div class="org-src-container">

<pre  class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">update_assert</span><span style="color: #AE81FF;">(</span>items, test_cases<span style="color: #AE81FF;">)</span>:
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Assert</span>
    <span style="color: #F92672;">for</span> i, item <span style="color: #F92672;">in</span> <span style="color: #F92672;">enumerate</span><span style="color: #AE81FF;">(</span>items<span style="color: #AE81FF;">)</span>:
        <span style="color: #F92672;">assert</span> item.sell_in == test_cases<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>.sell_in
        <span style="color: #F92672;">assert</span> item.quality == test_cases<span style="color: #AE81FF;">[</span>i<span style="color: #AE81FF;">][</span><span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">]</span>.quality
</pre>
</div>

</section>
<section >

<p>
Then, the test function for all the <code>Backstage passes...</code> cases would look like this:
</p>

<div class="org-src-container">

<pre  class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">test_backstage_passes_items</span><span style="color: #AE81FF;">()</span>:
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Arrange</span>
    <span style="color: #FD971F;">test_cases</span> = <span style="color: #AE81FF;">[</span>
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Backstage passes to a TAFKAL80ETC concert"</span>, <span style="color: #AE81FF;">20</span>, <span style="color: #AE81FF;">4</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Backstage passes to a TAFKAL80ETC concert"</span>, <span style="color: #AE81FF;">19</span>, <span style="color: #AE81FF;">5</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Backstage passes to a TAFKAL80ETC concert"</span>, <span style="color: #AE81FF;">10</span>, <span style="color: #AE81FF;">5</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Backstage passes to a TAFKAL80ETC concert"</span>, <span style="color: #AE81FF;">9</span>, <span style="color: #AE81FF;">7</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Backstage passes to a TAFKAL80ETC concert"</span>, <span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">6</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Backstage passes to a TAFKAL80ETC concert"</span>, <span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">9</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Backstage passes to a TAFKAL80ETC concert"</span>, <span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">6</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Backstage passes to a TAFKAL80ETC concert"</span>, -<span style="color: #AE81FF;">1</span>, <span style="color: #AE81FF;">0</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Backstage passes to a TAFKAL80ETC concert"</span>, <span style="color: #AE81FF;">10</span>, <span style="color: #AE81FF;">49</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Backstage passes to a TAFKAL80ETC concert"</span>, <span style="color: #AE81FF;">9</span>, <span style="color: #AE81FF;">50</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Backstage passes to a TAFKAL80ETC concert"</span>, <span style="color: #AE81FF;">5</span>, <span style="color: #AE81FF;">49</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Backstage passes to a TAFKAL80ETC concert"</span>, <span style="color: #AE81FF;">4</span>, <span style="color: #AE81FF;">50</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
    <span style="color: #AE81FF;">]</span>
</pre>
</div>

</section>
<section >

<div class="org-src-container">

<pre  class="src src-python"><span style="color: #FD971F;">items</span>, <span style="color: #FD971F;">gilded_rose</span> = update_arrange<span style="color: #AE81FF;">(</span>test_cases<span style="color: #AE81FF;">)</span>
<span style="color: #75715E;"># </span><span style="color: #75715E;">Act</span>
gilded_rose.update_quality<span style="color: #AE81FF;">()</span>
<span style="color: #75715E;"># </span><span style="color: #75715E;">Assert</span>
update_assert<span style="color: #AE81FF;">(</span>items, test_cases<span style="color: #AE81FF;">)</span>
</pre>
</div>

</section>
<section >

<p>
All other tests can be adapted to use these, and everything should still work:
</p>

<div class="org-src-container">

<pre  class="src src-bash">pytest .
</pre>
</div>

<pre class="example">
============================= test session starts ==============================
platform linux -- Python 3.5.4, pytest-3.2.3, py-1.4.34, pluggy-0.4.0
rootdir: /home/ifosch/src/github.com/BCNDojos/pyDojos/gilded-rose, inifile:
collected 3 items

test_gilded_rose.py ...

=========================== 3 passed in 0.02 seconds ===========================
</pre>

</section>
<section id="slide-org48ce5c0">
<h4 id="org48ce5c0">Equipping <code>Sulfuras...</code> items</h4>
<p>
Next step will be to implement tests for <code>Sulfuras...</code> items.
</p>

</section>
<section >

<p>
In this case, the approach of duplicating the test function for <code>Sulfuras...</code> will be enough.
</p>

<p>
Then, the test function for all the <code>Sulfuras...</code> cases would look like this:
</p>

<div class="org-src-container">

<pre  class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">test_sulfuras_items</span><span style="color: #AE81FF;">()</span>:
    <span style="color: #75715E;"># </span><span style="color: #75715E;">Arrange</span>
    <span style="color: #FD971F;">test_cases</span> = <span style="color: #AE81FF;">[</span>
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Sulfuras, Hand of Ragnaros"</span>, <span style="color: #AE81FF;">20</span>, <span style="color: #AE81FF;">4</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Sulfuras, Hand of Ragnaros"</span>, <span style="color: #AE81FF;">20</span>, <span style="color: #AE81FF;">4</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
        <span style="color: #66D9EF;">(</span>
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Sulfuras, Hand of Ragnaros"</span>, <span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">54</span><span style="color: #A6E22E;">)</span>,
            Item<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"Sulfuras, Hand of Ragnaros"</span>, <span style="color: #AE81FF;">0</span>, <span style="color: #AE81FF;">54</span><span style="color: #A6E22E;">)</span>,
        <span style="color: #66D9EF;">)</span>,
    <span style="color: #AE81FF;">]</span>
    ...
</pre>
</div>

</section>
<section >

<p>
All tests should still pass:
</p>

<div class="org-src-container">

<pre  class="src src-bash">pytest .
</pre>
</div>

<pre class="example">
============================= test session starts ==============================
platform linux -- Python 3.5.4, pytest-3.2.3, py-1.4.34, pluggy-0.4.0
rootdir: /home/ifosch/src/github.com/BCNDojos/pyDojos/gilded-rose, inifile:
collected 4 items

test_gilded_rose.py ....

=========================== 4 passed in 0.02 seconds ===========================
</pre>

</section>
</section>
<section>
<section id="slide-orgc574332">
<h3 id="orgc574332">Getting down the dungeon</h3>
<p>
Once you get your tests completed and your <code>golden_master</code> ready, you can go ahead and start refactoring the <code>update_quality</code> method&#x2026;
Remember running your tests often and good luck!
</p>

</section>
<section id="slide-orgf542467">
<h4 id="orgf542467">Refactor 1</h4>
<div class="outline-text-4" id="text-orgf542467">
</div>
<ul class="org-ul">
<li><a id="orgf9d7a3c"></a>Isolate <code>Sulfuras...</code><br />
<p>
First, add <code>if item.name == sulfuras</code> with continue, and keep the rest of the code, otherwise.
In that part, remove mentions to <code>Sulfuras...</code>, and fix indentation.
</p>
</li>

<li><a id="org7837a43"></a>Refactor all increasings and decreasings<br />
<p>
Make all increasings and decreasings use combined assignment.
</p>
</li>

<li><a id="org76901f3"></a>Isolate <code>Aged Brie</code><br />
<p>
Add branch in first level branching for <code>Aged Brie</code>.
Then, remove unnecessary code under the first level <code>else</code>.
</p>
</li>

<li><a id="org88a3862"></a>Isolate <code>Backstage passes...</code><br />
<p>
Add branch in first level branching for <code>Backstage passes...</code>.
Then, remove unnecessary code under the first level <code>else</code>.
</p>
</li>
</ul>

</section>
<section id="slide-org135365b">
<h4 id="org135365b">Refactor 1 (II)</h4>
<div class="outline-text-4" id="text-org135365b">
</div>
<ul class="org-ul">
<li><a id="org97f5bde"></a>Generalize quality increasings and decreasings<br />
<p>
Create <code>increase_quality(item)</code> and <code>decrease_quality(item)</code> functions implementing the update with the appropriate checks.
Make use of these functions where appropriate.
</p>
</li>

<li><a id="org29f2c5a"></a>Push <code>sell_in</code> decrease to the end of function<br />
<p>
Move <code>items.sell_in -= 1</code> to the end of the <code>update_quality</code> method, and update all thresholds.
</p>
</li>

<li><a id="org1aa4e20"></a>Add <code>get_quality_differential</code> to calculate quality differential for increasings<br />
<p>
Add <code>get_quality_differential</code>, and make <code>increase_quality</code> to use it.
</p>
</li>
</ul>

</section>
<section id="slide-org0ffc9ec">
<h4 id="org0ffc9ec">Refactor 1 (III)</h4>
<div class="outline-text-4" id="text-org0ffc9ec">
</div>
<ul class="org-ul">
<li><a id="org528c03c"></a>Add <code>arrange_quality</code> function and use it in <code>increase_quality</code><br />
<p>
The <code>arrange_quality</code> function ensures quality is never bigger than 50.
</p>
</li>

<li><a id="orgb97b6fa"></a>Include <code>thresholds</code> to increasings and quality differential calculation<br />
<p>
Make <code>get_quality_differential</code> to accept a list of values to repeat the differential increase.
Make <code>increase_quality</code> to accept the same parameters, and pass it over to <code>get_quality_differential</code> call.
Update appropriate <code>increase_quality</code> calls to use correct values.
</p>
</li>

<li><a id="org9cd28d4"></a>Make <code>decrease_quality</code> to use <code>arrange_quality</code><br />
<p>
Make <code>arrange_quality</code> to arrange value when it is less than 0.
Make <code>decrease_quality</code> use it.
</p>
</li>
</ul>

</section>
<section id="slide-org99f665a">
<h4 id="org99f665a">Refactor 1 (IV)</h4>
<div class="outline-text-4" id="text-org99f665a">
</div>
<ul class="org-ul">
<li><a id="org57333a0"></a>Extend <code>get_quality_differential</code> for decreasings<br />
<p>
Make <code>get_quality_differential</code> to calculate it for decreasings.
</p>
</li>

<li><a id="org25d5ffc"></a>Add expired to <code>get_quality_differential</code> and make <code>increase_quality</code> use it<br />
<p>
Put condition in <code>update_quality</code> branch for <code>Backstage passes...</code>.
</p>
</li>
</ul>

</section>
</section>
<section>
<section id="slide-org6491eef">
<h3 id="org6491eef">The return to the Gilded Rose Inn</h3>
<p>
Your task now is to add the new feature to our system so that we can begin selling a new category of items.
We have recently signed a supplier of conjured items.
This requires an update to our system:
</p>

<ul>
<li>“Conjured” items degrade in quality twice as fast as normal items</li>

</ul>

<p>
Same rules on Items class and items property apply here.
</p>

</section>
</section>
<section>
<section id="slide-org09870be">
<h2 id="org09870be">Gilded Rose Refactoring Kata Retrospective</h2>
<ul>
<li>Importance of running examples</li>
<li>Relevance of business rules vs current implementation</li>
<li>Importance of tests</li>
<li>Test functions distribution</li>
<li>Test refactoring</li>

</ul>
</section>
</section>
</div>
</div>
<script src="http://cdn.jsdelivr.net/reveal.js/3.0.0/lib/js/head.min.js"></script>
<script src="http://cdn.jsdelivr.net/reveal.js/3.0.0/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
overview: true,
width: 1200,
height: 800,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
transitionSpeed: 'default',
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/lib/js/classList.js', condition: function() { return !document.body.classList; } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]
});
</script>
</body>
</html>
